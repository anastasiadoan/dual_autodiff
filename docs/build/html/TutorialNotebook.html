<!DOCTYPE html>

<html lang="English" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dual_autodiff &#8212; dual_autodiff na documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=6ee2ba6e"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api_reference.html" />
    <link rel="prev" title="Tutorials" href="tutorials.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Dual_autodiff">
<h1>Dual_autodiff<a class="headerlink" href="#Dual_autodiff" title="Link to this heading">¶</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p>Consider the dual number <em>x = a + bε</em>. Then, <em>x² = (a + bε)² = a² + 2abε</em>. Note that the derivative of <em>x²</em> with respect to <em>x</em> is <em>2ax</em>. Thus, with <em>b = 1</em>, the dual part of <em>x²</em>, i.e., <em>2abε</em>, is the derivative of <em>x²</em> with respect to <em>x</em> evaluated at <em>x = a</em>.</p>
<p>In fact, you can show that any function <em>f(x)</em> can be extended to dual numbers and that its dual part is its derivative. You have:</p>
<p><em>f(a + bε) = f(a) + f'(a)bε</em></p>
<p>We refer to the part of the course on differentiable programming and the <a class="reference external" href="https://en.wikipedia.org/wiki/Dual_number">Wikipedia page</a> for more details and references therein.</p>
</section>
<section id="User-guide">
<h2>User guide<a class="headerlink" href="#User-guide" title="Link to this heading">¶</a></h2>
<section id="Installation">
<h3>Installation<a class="headerlink" href="#Installation" title="Link to this heading">¶</a></h3>
<p>To install the package, install it using</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import dual_autodiff
</pre></div>
</div>
</div>
<p>You can start using the module by:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from dual_autodiff import Dual
</pre></div>
</div>
</div>
</section>
<section id="Basic-Usage">
<h3>Basic Usage<a class="headerlink" href="#Basic-Usage" title="Link to this heading">¶</a></h3>
<p>The package has one main module called Dual. In this module, many mathematical operations are ready to use. We also add some more complex functions such as hyperbolic functions. All you have to do is call the function, put in the correct inputs and it will run smooth as butter.</p>
<p>Here are some examples of how we make and define the function</p>
</section>
</section>
<section id="Examples">
<h2>Examples<a class="headerlink" href="#Examples" title="Link to this heading">¶</a></h2>
<p>If you want to add two dual number, (6,2) and (3,1)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(6,2)
y = Dual(3,1)

print(x+y)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dual(real=9, dual=3)
</pre></div></div>
</div>
<p>Or if you want to see the multiplication of two dual number (6,2) and (3,1)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(6,2)
y = Dual(3,1)

print(x*y)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dual(real=18, dual=12)
</pre></div></div>
</div>
<p>Or the sin of the dual number (2,1) cannot be easier to find</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(2,1)
print(x.sin())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dual(real=0.9092974268256817, dual=-0.4161468365471424)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import math
z = math.sin(2)
z
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9092974268256817
</pre></div></div>
</div>
<p>As you can see from here, if the dual component of a dual number x is 1 then the real component of the value of a function that is applied to x is actually the derivative of that function applied to the real part of x.</p>
<p>i.e, the real component of x.sin() is actually the derivative of sin() applied to the real component of x i.e, sin(2) = 0.909</p>
<p>The package also allows you to conduct exponential function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(2,1)
print(x.exp())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dual(real=7.38905609893065, dual=7.38905609893065)
</pre></div></div>
</div>
<p>and also logarithm if you want it the other way round</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(7.389, 7.389)
print(x.log())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dual(real=1.9999924078065106, dual=1.0)
</pre></div></div>
</div>
<section id="Errors">
<h3>Errors<a class="headerlink" href="#Errors" title="Link to this heading">¶</a></h3>
<p>To use the package or make it run properly, inputs should be handled with care.</p>
<p>For example, normal mathematical properties are applied. We cannot take the logarithm of a non-positive real part:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(-1, 3)
print(x.log())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[14], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> x = Dual(-1, 3)
<span class="ansi-green-fg">----&gt; 2</span> print(x.log())

File <span class="ansi-green-fg">~/nad60/c1/nad60/dual_autodiff/dual.py:229</span>, in <span class="ansi-cyan-fg">Dual.log</span><span class="ansi-blue-fg">(self, base)</span>
<span class="ansi-green-intense-fg ansi-bold">    216</span> &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    217</span> Compute the logarithm of the dual number.
<span class="ansi-green-intense-fg ansi-bold">    218</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    226</span>     ValueError: If the real part is non-positive.
<span class="ansi-green-intense-fg ansi-bold">    227</span> &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    228</span> if self.real &lt;= 0:
<span class="ansi-green-fg">--&gt; 229</span>     raise ValueError(&#34;Log undefined for non-positive.&#34;)
<span class="ansi-green-intense-fg ansi-bold">    230</span> return Dual(math.log(self.real, base), self.dual / (self.real * math.log(base)))

<span class="ansi-red-fg">ValueError</span>: Log undefined for non-positive.
</pre></div></div>
</div>
<p>And we cannot calculate the tan value of a dual number that has cos() is equal to 0</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(math.pi/2, 1)
print(x.tan())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> x = Dual(math.pi/2, 1)
<span class="ansi-green-fg">----&gt; 2</span> print(x.tan())

File <span class="ansi-green-fg">~/nad60/c1/nad60/dual_autodiff/dual.py:196</span>, in <span class="ansi-cyan-fg">Dual.tan</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    193</span> def tan(self):
<span class="ansi-green-intense-fg ansi-bold">    194</span>     # Check if cosine is zero (tan is undefined when cos(real) = 0)
<span class="ansi-green-intense-fg ansi-bold">    195</span>     if math.isclose(math.cos(self.real), 0, abs_tol=1e-9):
<span class="ansi-green-fg">--&gt; 196</span>         raise ValueError(&#34;Tangent is undefined for cos(real) = 0.&#34;)
<span class="ansi-green-intense-fg ansi-bold">    198</span>     sec_squared = 1 / (math.cos(self.real) ** 2)
<span class="ansi-green-intense-fg ansi-bold">    199</span>     return Dual(math.tan(self.real), self.dual * sec_squared)

<span class="ansi-red-fg">ValueError</span>: Tangent is undefined for cos(real) = 0.
</pre></div></div>
</div>
<p>Or we don’t want you to put in your real part only:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(1)
print(x)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[17], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> x = Dual(1)
<span class="ansi-green-intense-fg ansi-bold">      2</span> print(x)

<span class="ansi-red-fg">TypeError</span>: __init__() missing 1 required positional argument: &#39;dual&#39;
</pre></div></div>
</div>
<p>And of course we cannot find any dual numbers with letters/string real or dual component</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = Dual(1, &quot;one&quot;)
print(x)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[19], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> x = Dual(1, &#34;one&#34;)
<span class="ansi-green-intense-fg ansi-bold">      2</span> print(x)

File <span class="ansi-green-fg">~/nad60/c1/nad60/dual_autodiff/dual.py:32</span>, in <span class="ansi-cyan-fg">Dual.__init__</span><span class="ansi-blue-fg">(self, real, dual)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     raise TypeError(f&#34;Real part must be a numeric type, got {type(real).__name__}&#34;)
<span class="ansi-green-intense-fg ansi-bold">     31</span> if not isinstance(dual, (int, float)):
<span class="ansi-green-fg">---&gt; 32</span>     raise TypeError(f&#34;Dual part must be a numeric type, got {type(dual).__name__}&#34;)
<span class="ansi-green-intense-fg ansi-bold">     33</span> self.real = real
<span class="ansi-green-intense-fg ansi-bold">     34</span> self.dual = dual

<span class="ansi-red-fg">TypeError</span>: Dual part must be a numeric type, got str
</pre></div></div>
</div>
<p>There are more to explore using the package, I hope you have fun playing with it!</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">dual_autodiff</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="tutorials.html">Tutorials</a><ul>
      <li>Previous: <a href="tutorials.html" title="previous chapter">Tutorials</a></li>
      <li>Next: <a href="api_reference.html" title="next chapter">API Reference</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ngoc Anh Doan.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/TutorialNotebook.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>